# Copyright 2000, International Business Machines Corporation and others.
# All Rights Reserved.
# 
# This software has been released under the terms of the IBM Public
# License.  For details, see the LICENSE file in the top-level source
# directory or online at http://www.openafs.org/dl/license10.html

srcdir=@srcdir@
include @TOP_OBJDIR@/src/config/Makefile.config
include @TOP_OBJDIR@/src/config/Makefile.pthread

LT_deps=$(top_builddir)/src/cmd/liboafs_cmd.la \
	 $(top_builddir)/src/util/liboafs_util.la \
	 $(top_builddir)/src/rx/liboafs_rx.la

all: rxdebug rxdumptrace

rxdebug.o: rxdebug.c

CFLAGS_rxdumptrace.o=-DDUMPTRACE
rxdumptrace.o: ../rx/rx_trace.c
	$(AFS_CCRULE) $(srcdir)/../rx/rx_trace.c

rxdumptrace: rxdumptrace.o $(LT_deps)
	$(LT_LDRULE_static) rxdumptrace.o $(LT_deps) $(LIB_roken) $(MT_LIBS)

rxdebug: rxdebug.o $(LT_deps)
	$(LT_LDRULE_static) rxdebug.o $(LT_deps) $(LIB_roken) $(MT_LIBS)

#
# Install targets
#
install: rxdebug
	${INSTALL} -d ${DESTDIR}${sbindir}
	${INSTALL_PROGRAM} rxdebug ${DESTDIR}${sbindir}/rxdebug

dest: rxdebug
	${INSTALL} -d ${DEST}/etc
	${INSTALL_PROGRAM} rxdebug ${DEST}/etc/rxdebug

#
# Misc. targets
#
clean:
	$(RM) -f *.o *.a core *_component_version_number.c rxdumptrace rxdebug

include ../config/Makefile.version
